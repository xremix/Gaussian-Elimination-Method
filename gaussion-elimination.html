<!DOCTYPE html>
<html>
<head>
	<title>Gaussian Ellimination method</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
</head>
<body>
	<div class="container">
		<h1>Gaussian Ellimination method</h1>
		<div class="alert alert-info" role="alert"><a href="https://github.com/xremix/Gaussion-Elimination-Method" target="_blank">Usage and Docs</a>. The Input should be a matrix of the format <b>A|b</b> - meaning that you need to input a <b>n * n+1</b> Matrix. Columns are seperated by spaces.</div>
		<div class="col-md-6">
			<h3>Input</h3>
			<textarea id="matrixInput" class="form-control" rows="8">
3 6 3 24
2 1 3 13
3 2 4 19</textarea>
			</div>
			<div class="col-md-6">
				<h3>Matrix</h3>
				<div id="result" class="jumbotron"></div>
			</div>
			<div class="col-xs-12">
				<h3>Matrix in elminiated form</h3>
				<div id="result2" class="jumbotron"></div>
			</div>
			<div class="col-xs-12">
				<h3>Results</h3>
				<div id="result3" class="jumbotron"></div>
			</div>
		</div>
		<script type="text/javascript">
			'use strict';
			var gaussian ={
				tools:{
					cleanArray: function(arr) {
						for (var i = arr.length - 1; i >= 0; i--)
							if(arr[i] === "" || arr[i] === undefined || arr[i] === null)
								arr.splice(i, 1);
						return arr;
					}
				},
				ui: {
					clearContent: function(containerid){
						document.getElementById(containerid).innerText = '';
					},
					writeMatrix: function(containerid, mtr){
						for (var i = 0; i < mtr.length; i++) {
							var row = mtr[i];
							for (var j = 0; j < row.length; j++) {
								document.getElementById(containerid).innerHTML += row[j] + ' ';
								if(j == row.length-2){
									document.getElementById(containerid).innerHTML += ' = ';
								}
							}
							document.getElementById(containerid).innerText += '\n';
						}
					},
					writeResult: function(containerid, row){
						for (var i = 0; i < row.length; i++) {
							if (!isNaN(parseFloat(row[i]))){
								var identifier = String.fromCharCode(97 + i);
								document.getElementById(containerid).innerText += identifier + ' = ' + row[i] + '\n';	
							}
						}
					},
					stringToMatrix: function(str){
						var result = str.trim().split('\n');
						for (var i = 0; i < result.length; i++) {
							result[i] = result[i].split(' ');
							result[i] = gaussian.tools.cleanArray(result[i]);

							for (var j = 0; j < result[i].length; j++) {
								result[i][j] = JSON.parse(result[i][j]);
							}
						}
						console.log(result);
						return result;
					},
				},
				calculator:{
					calcRows: function(row1, row2, id){
						var result = [];
						for (var i = 0; i < row1.length; i++) {
							var row1Res = row1[id] * row2[i];
							var row2Res = row2[id] * row1[i];
							result.push(row1Res - row2Res);
						}  
						return result;
					},
					calculateMatrix: function(mtr){
						gaussian.ui.writeMatrix('result', mtr);
						var runner = 0;
						while(runner+1 < mtr.length){
							for (var i = runner+1; i < mtr.length; i++) {
								mtr[i] = gaussian.calculator.calcRows(mtr[runner], mtr[i], runner);
							}
							runner++;
						}
						gaussian.ui.writeMatrix('result2', mtr);
					},
					resolveMatrixResults: function(mtr){
						var mtrResults = new Array(mtr[0].length-1);

						for (var i = 1; i <= mtr.length; i++) {

							var row = mtr[mtr.length-i];
							var rowResult = row[row.length-1];
							var secondValue = row[row.length-i-1];
							var additionalValue = 0;

							for (var j = mtrResults.length - 1; j >= 0; j--) {
								if(mtrResults[j]){
									additionalValue += mtrResults[j] * row[j];
								}
							}

							mtrResults[mtrResults.length-i] = (rowResult - additionalValue) / secondValue;
						}
						gaussian.ui.writeResult('result3', mtrResults);
						return mtrResults;
					}
				},
				calculateWholeMatrix: function(){
					gaussian.ui.clearContent('result');
					gaussian.ui.clearContent('result2');
					gaussian.ui.clearContent('result3');
					matrix = gaussian.ui.stringToMatrix(document.getElementById("matrixInput").value);
					gaussian.calculator.calculateMatrix(matrix);
					gaussian.calculator.resolveMatrixResults(matrix);
				}
			};
			var matrix = [];
			document.getElementById('matrixInput').onkeyup = function(){
				gaussian.calculateWholeMatrix();
			};
			gaussian.calculateWholeMatrix();
		</script>

	</body>
	</html>